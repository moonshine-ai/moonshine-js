!function(){"use strict";chrome.runtime.onMessage.addListener((async e=>("overlay"===e.target&&chrome.tabs.query({active:!0,currentWindow:!0},(function(t){t&&chrome.tabs.sendMessage(t[0].id,e)})),!0))),chrome.action.onClicked.addListener((async e=>{let t=!1;const r=(await chrome.runtime.getContexts({})).find((e=>"OFFSCREEN_DOCUMENT"===e.contextType));if(r?t=r.documentUrl.endsWith("#recording"):await chrome.offscreen.createDocument({url:"offscreen.html",reasons:["USER_MEDIA"],justification:"Recording from chrome.tabCapture API"}),t)return chrome.runtime.sendMessage({type:"stop-recording",target:"offscreen"}),void chrome.action.setIcon({path:"icons/not-recording.png"});const n=await chrome.tabCapture.getMediaStreamId({targetTabId:e.id});chrome.runtime.sendMessage({type:"start-recording",target:"offscreen",data:n}),chrome.action.setIcon({path:"/icons/recording.png"})}))}();
